<!DOCTYPE html>
<html>
<head>
    <title>ScreenPresent</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: #ffffff;
            color: #1d1d1f;
            height: 100vh;
            overflow: hidden;
        }

        .container {
            padding: 16px;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            box-sizing: border-box;
        }

        .logo {
            font-size: 20px;
            margin: 16px 0;
            font-weight: 500;
            letter-spacing: -0.5px;
        }

        .permissions-section {
            background: #ffffff;
            padding: 16px;
            border-radius: 12px;
            width: 100%;
            box-sizing: border-box;
            margin-bottom: 16px;
        }

        .section-title {
            font-size: 14px;
            color: #86868b;
            margin-bottom: 12px;
            font-weight: 500;
        }

        .recording-options {
            display: none;
            width: 100%;
        }

        .recording-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            width: 100%;
        }

        .record-option {
            background: #f5f5f7;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background-color 0.2s;
            padding: 16px;
            aspect-ratio: 1;
        }

        .record-option:hover {
            background: #e8e8ed;
        }

        .record-option svg {
            width: 24px;
            height: 24px;
            margin-bottom: 8px;
            stroke: #1d1d1f;
            fill: none;
            stroke-width: 1.5;
        }

        .record-option h3 {
            margin: 0;
            font-size: 12px;
            text-align: center;
            font-weight: 500;
            color: #1d1d1f;
        }

        .permission-button {
            padding: 12px;
            background: #f5f5f7;
            border: none;
            border-radius: 8px;
            color: #1d1d1f;
            cursor: pointer;
            font-family: inherit;
            font-size: 13px;
            margin: 8px 0;
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: background-color 0.2s;
        }

        .permission-button:hover {
            background: #e8e8ed;
        }

        .permission-button.granted {
            background: #e3f4e4;
            color: #1d1d1f;
        }

        .permission-button.denied {
            background: #fef1f1;
            color: #d93025;
        }

        .permission-status {
            font-size: 12px;
            color: #86868b;
            font-weight: 500;
        }

        .permission-button.granted .permission-status {
            color: #34a853;
        }

        .permission-button.denied .permission-status {
            color: #d93025;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="logo">ScreenPresent</div>
        
        <!-- Permission Section -->
        <div class="permissions-section" id="permissionsSection">
            <div class="section-title">Required Permissions</div>
            
            <button id="screenPermissionBtn" class="permission-button">
                <span>Screen Recording</span>
                <span class="permission-status">Not Granted</span>
            </button>
            
            <button id="accessibilityPermissionBtn" class="permission-button">
                <span>Accessibility</span>
                <span class="permission-status">Not Granted</span>
            </button>
        </div>

        <!-- Recording Options -->
        <div class="recording-options" id="recordingOptions">
            <div class="section-title">Select Recording Mode</div>
            <div class="recording-grid">
                <div class="record-option" onclick="captureEntireDesktop()">
                    <svg viewBox="0 0 24 24">
                        <rect x="3" y="3" width="18" height="18" rx="2"/>
                        <line x1="3" y1="8" x2="21" y2="8"/>
                    </svg>
                    <h3>Full Screen</h3>
                </div>

                <div class="record-option" onclick="captureWindow()">
                    <svg viewBox="0 0 24 24">
                        <rect x="5" y="5" width="14" height="14" rx="2"/>
                        <rect x="8" y="8" width="14" height="14" rx="2"/>
                    </svg>
                    <h3>Window</h3>
                </div>

                <div class="record-option" onclick="captureArea()">
                    <svg viewBox="0 0 24 24">
                        <path d="M4,4 L9,4 M15,4 L20,4 M4,20 L9,20 M15,20 L20,20 M4,4 L4,9 M4,15 L4,20 M20,4 L20,9 M20,15 L20,20"/>
                    </svg>
                    <h3>Region</h3>
                </div>
            </div>
        </div>
    </div>

    <script>
        const { ipcRenderer } = require('electron');

        // Screen Recording Permission
        const screenPermBtn = document.getElementById('screenPermissionBtn');
        const screenPermStatus = screenPermBtn.querySelector('.permission-status');
        const permissionsSection = document.getElementById('permissionsSection');
        
        screenPermBtn.addEventListener('click', async () => {
            try {
                const granted = await ipcRenderer.invoke('request-screen-permission');
                updatePermissionButton(screenPermBtn, screenPermStatus, granted);
                checkAllPermissions();
            } catch (error) {
                screenPermStatus.textContent = 'Error';
                screenPermBtn.classList.add('denied');
            }
        });

        // Accessibility Permission
        const accessibilityPermBtn = document.getElementById('accessibilityPermissionBtn');
        const accessibilityPermStatus = accessibilityPermBtn.querySelector('.permission-status');
        
        accessibilityPermBtn.addEventListener('click', async () => {
            await ipcRenderer.invoke('open-accessibility-preferences');
            checkAccessibilityPermission();
        });

        async function checkAccessibilityPermission() {
            const granted = await ipcRenderer.invoke('check-accessibility-permission');
            updatePermissionButton(accessibilityPermBtn, accessibilityPermStatus, granted);
            checkAllPermissions();
        }

        function updatePermissionButton(button, statusElement, granted) {
            button.classList.remove('granted', 'denied');
            button.classList.add(granted ? 'granted' : 'denied');
            statusElement.textContent = granted ? 'Granted' : 'Not Granted';
        }

        async function checkAllPermissions() {
            const screenGranted = await ipcRenderer.invoke('request-screen-permission');
            const accessibilityGranted = await ipcRenderer.invoke('check-accessibility-permission');

            if (screenGranted && accessibilityGranted) {
                document.getElementById('recordingOptions').style.display = 'block';
                permissionsSection.style.display = 'none';
            } else {
                document.getElementById('recordingOptions').style.display = 'none';
                permissionsSection.style.display = 'block';
            }
        }

        // Initial permission check
        checkAllPermissions();
        checkAccessibilityPermission();

        // Recording functions
        function captureEntireDesktop() {
            console.log('Capture entire desktop clicked');
        }

        function captureWindow() {
            console.log('Capture window clicked');
        }

        function captureArea() {
            console.log('Capture area clicked');
        }
    </script>
</body>
</html> 